# 开发记录





## 问题与分析

### 多旋翼返航爬升

#### 时间

2023.01.26

#### 描述

切换为多旋翼模态并进入返航模式后，无人机在返航过程中一直爬高。

#### 问题分析

当多旋翼切入返航时，首先需要计算返航高度。返航高度计算逻辑是取默认高度和圆锥几何返航高度的最大值，其中默认返航为60m，圆锥几何返航高度却是300米，导致返航高度过高，无人机不断爬升。

其中圆锥几何返航高度由参数NAV_ACC_RAD的两倍决定，该值设置为了150，只要将该值改小即可解决。

### 不控高度时高度异常爬升

#### 时间

2023.01.26

#### 描述

SDK提供了航向、巡航速度控制接口函数。通过调用该函数，会造成无人机一直爬升的情况发生。

#### 问题分析

由于飞控没有接收到高度指令，在飞控代码中将高度期望设置了NAN无效值，导致计算爬升率时逻辑出错，经过限幅器后生成了一个很大的爬升速率（5m/s）。

修改飞控代码和控制逻辑，当没有收到高度指令时使用当前高度作为期望高度，保持当前高度飞行。